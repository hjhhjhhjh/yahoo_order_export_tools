!function(){if(console.clear(),page_link_cache={length:0},order_cache={},link=[],data=[],startPage=1,endPage=1,dataTableFH="",orderCount=-1,loadCount=0,!document.f2||!document.f2.action||"undefined"==typeof jQuery)return console.log("只支持在订单列表页面执行"),void alert("只支持在订单列表页面执行");oDocumentWrite=null,jQbody=null,document.write=function(e){oDocumentWrite||(oDocumentWrite=document.write,jQbody=$("body"),document.body.innerHTML=""),jQbody.append(e)};var e=parseInt($("#SearchRecordPage").val()),t=parseInt("1"),i=parseInt($("#pagePage").val()),a=parseInt((t+e-1)/e);page_link_cache["_"+i]=[];for(var o=0;o<e;o++)1==$("#orderId"+o).length&&(linkAddr=$("#orderId"+o).attr("onclick").split("'")[1],page_link_cache["_"+i].push(linkAddr));page_link_cache.length+=page_link_cache["_"+i].length;var n={};$(document.f2).find("input").each((e,t)=>{t.name&&""!=t.name&&(n[t.name]=t.value)});var r=document.f2.action;getotherlink=function(t,i,o){if(location.href.startsWith("file://"))return console.log("本地环境，直接返回。"),void gotoGetInfo();i||(i=a),t<=i?(console.log("正在获取",t,"页的数据，请稍候"),page_link_cache["_"+t]?(console.log("获取第 "+t+"/"+i+" 页 完成"),o?getotherlink(t+1,i,o):t==i&&(console.log("所有页面获取完成,共有 "+page_link_cache.length+" 个订单 "),gotoGetInfo())):(n.page=t,$.post(r,n,function(a){page_link_cache["_"+t]=[];for(var n=0;n<parseInt(e);n++)1==$(a).find("#orderId"+n).length&&(linkAddr=$(a).find("#orderId"+n).attr("onclick").split("'")[1],page_link_cache["_"+t].push(linkAddr));page_link_cache.length+=page_link_cache["_"+t].length,console.log("获取第 "+t+"/"+i+" 页 完成"),o?getotherlink(t+1,i,o):t==i&&(console.log("所有页面获取完成,共有 "+page_link_cache.length+" 个订单 "),gotoGetInfo())}))):(console.log("所有页面获取完成,共有 "+page_link_cache.length+" 个订单 "),gotoGetInfo())},getInfo=function(e){if(location.href.startsWith("file://"))return data=[{payInfo:"入金済み",cancelReason:"",cancelReasonDetail:"",parentOrderId:"",orderTime:"2019-12-22T20:09:29+09:00",releaseDate:"",deviceType:"3",isRoyaltyFix:"true",royaltyFixTime:"2019-12-26T11:35:52+09:00",firstOrderDoneDate:"2019-12-26",isLogin:"true",fspLicenseName:"プラチナ",usePointType:"T",isAffiliate:"false",orderId:"kidscoordinate-10000019",suspect:"0",suspectMessage:"",childOrderId:"",orderStatus:"5",isSeen:"true",beforeOrderStatus:"5",isUsePointFix:"",refundStatus:"",refundTotalPrice:"",shipZipCode:"6038112",shipPrefecture:"京都府",shipCity:"京都市北区",shipAddress1:"小山元町4 薮方",shipAddress2:"",shipPrefectureKana:"",shipCityKana:"",shipAddress1Kana:"",shipAddress2Kana:"",shipLastName:"中河",shipFirstName:"多香子",shipLastNameKana:"ナカガワ",shipFirstNameKana:"タカコ",shipPhoneNumber:"0754912041",shipEmgPhoneNumber:"",shipSection1Field:"",shipSection1Value:"",shipSection2Field:"",shipSection2Value:"",needGiftWrap:"",giftWrapType:"",giftWrapMessage:"",needGiftWrapPaper:"",giftWrapPaperType:"",giftWrapName:"",option1Field:"",option1Value:"",option2Field:"",option2Value:"",shipRequestDate:"",shipRequestTime:"",shipRequestTimeStart:"00",shipRequestTimeEnd:"",arriveType:"0",shipNotes:"",shipDate:"2019-12-25",arrivalDate:"2019-12-27",shipCompanyCode:"1002",shipInvoiceNumber1:"517766961342",shipInvoiceNumber2:"",shipUrl:"",shipMethod:"postage2",shipMethodName:"佐川急便",isLinkDeliverSeino:"false",beforeShipStatus:"3",billZipCode:"6038112",billPrefecture:"京都府",billCity:"京都市北区",billAddress1:"小山元町4 薮方",billAddress2:"",billPrefectureKana:"",billCityKana:"",billAddress1Kana:"",billAddress2Kana:"",billLastName:"中河",billFirstName:"多香子",billLastNameKana:"ナカガワ",billFirstNameKana:"タカコ",billPhoneNumber:"0754912041",billEmgPhoneNumber:"",billMailAddress:"lamune1107@gmail.com",needDetailedSlip:"",needReceipt:"",needBillSlip:"",buyerComments:"",billSection1Field:"",billSection1Value:"",billSection2Field:"",billSection2Value:"",payActionTime:"2019-12-26T11:35:52+09:00",ageConfirmField:"",ageConfirmValue:"",ageConfirmCheck:"",payMethod:"payment_a17",payMethodName:"PayPay残高払い",payMethodAmount:"481",payKind:"6",combinedPayMethod:"payment_a1",combinedPayMethodName:"クレジットカード決済",combinedPayMethodAmount:"2865",combinedPayKind:"0",settleStatus:"5",settleId:"k1912228582505",isAutoPayNo:"",cardPayType:"1",cardPayCount:"",payNo:"",payNoIssueDate:"",agencyNumber:"",confirmNumber:"",beforePayStatus:"1",paymentTitle:"",payment_sort:"a1%_^A_%a17%_^A_%a16%_^A_%a9%_^A_%a10%_^A_%a11%_^A_%a8%_^A_%a6%_^A_%a7%_^A_%b1%_^A_%d1","paymentTitleList[b1]":"城北信用金庫","paymentTitleList[d1]":"商品代引",useCouponData:"cDhyOTRtVkFEQ3hTJmtpZCYxNTc2NDY4NTgx\\A500円OFF-対象商品限定\\A1\\Aladiesfashion\\A1\\B",totalCouponDiscount:"500",shippingCouponDiscount:"0",shippingCouponFlg:"0",couponCampaignCode:"",totalMallCouponDiscount:"",giftWrapCharge:"0",shipCharge:"600",payCharge:"0",discount:"0",title1:"ダッフルコート レディース ロング アウター ジャケット グレー 秋冬 2019新作 人気",subCodeOption1:"",itemOption1:"カラー�グレー�サイズ�フリーサイズ",inscription1:"",itemId1:"1107lt3225",subCode1:"1107lt3225-01",unitPrice1:"2870",priceType1:"1",quantity1:"1",releaseDate1:"",pointFspCode1:"",unitGetPoint1:"28",getPointType1:"T",isGetPointFix1:"true",getPointFixDate1:"2019-12-27",lineTotalPrice1:"2870",isUsed1:"false",beforeReleaseDate1:"",subtotalPrice:"2870",usePoint:"124",totalPrice:"3346",itemCount:"1",cartMaxLine:"50",referer:"",entryPoint:"",isSeller:"false",csrf:"NjRjNGFiZjA4OTQ5ZDU2YjVjYzNkODcyODg4ZDE4MGVmNjQxNDgxNjU1Njk4NTM0YTNjMzgyOTc1ZDEyMGFlZllJM3ZzeUk4N2Y4cThjc0JyL0ZVbklCaVA1NFdiSENlYktQM1NkVEUrc0w2OWFybnNUSkhFc0R4QzVHNXRoWUJWQUxoYmJpQVhFQTlQQ3doZkt2YXZMeXhSdkFBZkFiZnlHR1ZmNUYwM2dLbTdZUXdSNTd1dEdZeUh5L1JDMjFmdGVnSUVBR3lMOUJ3amVrWU55YTFSQT09",yjbfp_items:"uaMozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36langzh-CNscreen_height1440screen_width2560timezone_offset-480pluginsChrome PDF Plugin|Chrome PDF Viewer|Native Clientcanvas_imageiVBORw0KGgoAAAANSUhEUgAAABAAAAAWCAYAAADJqhx8AAACT0lEQVQ4T9WUP0hbURSHP6NV1Ka0JVAs1IiNf6igUkRwCA4uIi6iJIMQNzUZBLcQhIAIDg4uChrHEFARRINCQMgSUUFQQ6WkxjY0xhcSLOp7FlttUu4TK2IjYqfe6d7DPd8553d/72XxjytL5KfTs+nHcv4jQH8/LC7C/v7tYR88wugorK3B7OwjAddpPl+ESOSUnp5qNfSng74+CIdhefmmgjibzTAyApubEAiAwyERiym0t5fdBrjdYLHAxgbU119BBgfB6QRZFokwPw/RaIYRFAW0WrDZIhiN55hMlej10NICw8PnOBxhAoE3TE6eEYvJmEwVtzsQJ6sV/P4kVusBen0ZbW1PWV2Fy8sDPJ4kPl81ExNRIpETentr7gLW18Fo/IXdHkSSXuD3l7C3By7XDsGgFq+3lKkpIWIGQDoNlZXQ0PCZROKExsZazGYZr3efUMjAwoL2foDoSbz30JBMXV0Yp7OEo6NvHB6esbtbrYp4bwcCEI9DURF0dgbp6ChQBautfcXMzOuHAYRVDQYYG5NIpeKqUF1dVdjtufh8MD6eQQNRWRjF5YKdHQiFLnC7P6DTFVBcXIHNdvXMAwMZAFtb8P791aWlJaiqOsfj+Uh5uZ7m5peUlorqkEp9IRqV71r5ev68vAsk6ZTt7QTHxz/o7q4hkchCp0sTj8usrHwlJ0eDxfLurg9ERJLOmJv7hEYDra1v0eufqReTye9MT4fIzc2mqakYg+H53wEiqigX5OfnkJ2tfmvqEh5RlJ8UFj5Bo7mJ3+we+VP8DR//QTKrkbYiAAAAAElFTkSuQmCC",dummy:"",radCancelReason:"230"}],console.log("本地环境，直接返回。"),void gotoShowData();if(-1==orderCount&&(orderCount=link.length),e){var t=link[e-1];order_cache[t]?(allInputValue=order_cache[t],console.log("获取 第 "+e+"/"+orderCount+" 个订单,"+allInputValue.orderId+" 有 "+allInputValue.itemCount+" 个商品,信息获取完成 "),e==link.length&&(console.log("没有更多订单了"),gotoShowData())):(loadCount++,$.get(t,function(i){var a=$(i);allInputValue={},payInfo=a.find("#ordBasic").find("td:last").text().trim(),allInputValue.payInfo=payInfo,a.find("input[name]").each((e,t)=>{allInputValue[t.name]=t.value}),order_cache[t]=allInputValue,console.log("获取 第 "+e+"/"+orderCount+" 个订单,"+allInputValue.orderId+" 有 "+allInputValue.itemCount+" 个商品,信息获取完成 "),loadCount--,e==link.length&&(console.log("没有更多订单了"),setTimeout(gotoShowData,1e3))}))}else if(link.length>0){t=link.pop();console.log("正在获取数据：第 "+(link.length+1)+"/"+orderCount+" 个订单 "),order_cache[t]?(allInputValue=order_cache[t],console.log(allInputValue.orderId+" 有 "+allInputValue.itemCount+" 个商品,信息获取完成 "),getInfo()):$.get(t,function(e){var i=$(e);allInputValue={},payInfo=i.find("#ordBasic").find("td:last").text().trim(),allInputValue.payInfo=payInfo,i.find("input[name]").each((e,t)=>{allInputValue[t.name]=t.value}),order_cache[t]=allInputValue,console.log(allInputValue.orderId+" 有 "+allInputValue.itemCount+" 个商品,信息获取完成 "),getInfo()})}else console.log("没有更多订单了"),gotoShowData()},sortByPayTime=function(e,t){if(""!=e.payActionTime&&""!=t.payActionTime)return new Date(e.payActionTime).getTime()-new Date(t.payActionTime).getTime();if(""!=e.payActionTime)return 1;if(""!=t.payActionTime)return-1;{let i=e.orderId.split("-"),a=t.orderId.split("-");return parseInt(i[i.length-1])-parseInt(a[a.length-1])}},document.querySelectorAll("table").forEach(e=>e.remove()),document.querySelectorAll("div").forEach(e=>e.remove());document.write("<style>label{cursor:pointer}  table.gridtable {font-family: verdana,arial,sans-serif;font-size:11px;color:#333333;border-width: 1px;border-color: #666666;border-collapse: collapse;width:1000px} table.gridtable th { border-width: 1px;padding: 8px;border-style: solid;border-color: #666666; background-color: #dedede;} table.gridtable td {border-width: 1px;padding: 8px;border-style: solid;border-color: #666666;background-color: #ffffff;}</style>");var l={"分组":"","销售账号":"","做表日期":"myNowDate","发货方法":"","备注":"",ID:"orderId","出品内容":"itemName","图片":"firstImg","发货地址":"myFullShipAddress","数量":"quantity","商品属性":"itemOption","运费(空)":"","销售额":"totalPrice","产品链接":"myLinkUrl","物流单号":"","目的地(空)":"","件数(空)":"","收件人":"shipLastName+shipFirstName","收件单位(空)":"","收件地址":"shipPrefecture+shipCity+shipAddress1+shipAddress2","收件邮编":"shipZipCode","收件电话":"shipPhoneNumber"},s=[];Object.keys(l).forEach((e,t)=>{s.push('<label for="'+e+'" >'+e+'</label><input type="checkbox" id="'+e+'" value="'+l[e]+'" class="dataColumn" onchange="addColumn(this)" checked="checked"/><span style="color:red;font-size:21px" id="'+e+'_number">'+(t+1)+"</span>")}),document.write("<div><h1>默认导出数据</h1></div>"),getTrStr=function(e,t){for(var i=[],a=[],o=0;o<e.length;o++)a.push("<td>"+e[o]+"</td>"),a.length==t&&(i.push("<tr>"+a.join("")+"</tr>"),a=[]);if(a.length>0){for(;a.length<t;)a.push("<td>&nbsp;</td>");i.push("<tr>"+a.join("")+"</tr>")}return i.join("")},document.write("<table class=gridtable >"+getTrStr(s,9)+"</table>"),addColumn=function(e){var t=e.id,i=document.querySelector("#"+t+"_number"),a=document.querySelectorAll(".dataColumn:checked");if(e.checked)i.innerHTML=a.length;else{var o=parseInt(i.innerHTML);i.innerHTML="",a.forEach(e=>{i=document.querySelector("#"+e.id+"_number");var t=parseInt(i.innerHTML);t>o&&(i.innerHTML=t-1)})}},document.write("<div><h1>可选导出数据 &nbsp;<label for='showOptionTab'>显示</label><input type='checkbox' id='showOptionTab' onchange='toggleOtherOptions(this)' /></h1></div>"),toggleOtherOptions=function(e){otherOptionsTab=document.querySelector("#otherOptionsTab"),e.checked?otherOptionsTab.style.display="block":otherOptionsTab.style.display="none"},defaultColumnStr=Object.values(l).join(";"),s=[],allColumns={cancelReason:"",cancelReasonDetail:"",parentOrderId:"",orderTime:"",releaseDate:"",deviceType:"",isRoyaltyFix:"",royaltyFixTime:"",firstOrderDoneDate:"",isLogin:"",fspLicenseName:"",usePointType:"",isAffiliate:"",orderId:"",suspect:"",suspectMessage:"",childOrderId:"",orderStatus:"",isSeen:"",beforeOrderStatus:"",isUsePointFix:"",refundStatus:"",refundTotalPrice:"",shipZipCode:"",shipPrefecture:"",shipCity:"",shipAddress1:"",shipAddress2:"",shipPrefectureKana:"",shipCityKana:"",shipAddress1Kana:"",shipAddress2Kana:"",shipLastName:"",shipFirstName:"",shipLastNameKana:"",shipFirstNameKana:"",shipPhoneNumber:"",shipEmgPhoneNumber:"",shipSection1Field:"",shipSection1Value:"",shipSection2Field:"",shipSection2Value:"",needGiftWrap:"",giftWrapType:"",giftWrapMessage:"",needGiftWrapPaper:"",giftWrapPaperType:"",giftWrapName:"",option1Field:"",option1Value:"",option2Field:"",option2Value:"",shipRequestDate:"",shipRequestTime:"",shipRequestTimeStart:"",shipRequestTimeEnd:"",arriveType:"",shipNotes:"",shipDate:"",arrivalDate:"",shipCompanyCode:"",shipInvoiceNumber1:"",shipInvoiceNumber2:"",shipUrl:"",shipMethod:"",shipMethodName:"",isLinkDeliverSeino:"",beforeShipStatus:"",billZipCode:"",billPrefecture:"",billCity:"",billAddress1:"",billAddress2:"",billPrefectureKana:"",billCityKana:"",billAddress1Kana:"",billAddress2Kana:"",billLastName:"",billFirstName:"",billLastNameKana:"",billFirstNameKana:"",billPhoneNumber:"",billEmgPhoneNumber:"",billMailAddress:"",needDetailedSlip:"",needReceipt:"",needBillSlip:"",buyerComments:"",billSection1Field:"",billSection1Value:"",billSection2Field:"",billSection2Value:"",payActionTime:"",ageConfirmField:"",ageConfirmValue:"",ageConfirmCheck:"",payMethod:"",payMethodName:"",payMethodAmount:"",payKind:"",combinedPayMethod:"",combinedPayMethodName:"",combinedPayMethodAmount:"",combinedPayKind:"",settleStatus:"",settleId:"",isAutoPayNo:"",cardPayType:"",cardPayCount:"",payNo:"",payNoIssueDate:"",agencyNumber:"",confirmNumber:"",beforePayStatus:"",paymentTitle:"",payment_sort:"","paymentTitleList[b1]":"","paymentTitleList[d1]":"",useCouponData:"",totalCouponDiscount:"",shippingCouponDiscount:"",shippingCouponFlg:"",couponCampaignCode:"",totalMallCouponDiscount:"",giftWrapCharge:"",shipCharge:"",payCharge:"",discount:"",title1:"",subCodeOption1:"",itemOption1:"",inscription1:"",itemId1:"",subCode1:"",unitPrice1:"",priceType1:"",quantity1:"",releaseDate1:"",pointFspCode1:"",unitGetPoint1:"",getPointType1:"",isGetPointFix1:"",getPointFixDate1:"",lineTotalPrice1:"",isUsed1:"",beforeReleaseDate1:"",subtotalPrice:"",usePoint:"",totalPrice:"",itemCount:"",cartMaxLine:"",referer:"",entryPoint:"",isSeller:"",csrf:"",yjbfp_items:"",dummy:"",radCancelReason:""},existColumns={},Object.keys(allColumns).forEach(e=>{oKey=e.replace(/\d+$/,""),existColumns[oKey]||-1!=defaultColumnStr.indexOf(oKey)||(s.push('<label for="'+oKey+'">'+oKey+'</label><br/><input type="checkbox" id="'+oKey+'" value="'+oKey+'" class="dataColumn" onchange="addColumn(this)"/><span style="color:red;font-size:21px" id="'+oKey+'_number"></span>'),existColumns[oKey]=!0)}),document.write("<table class=gridtable id='otherOptionsTab' style='display:none'>"+getTrStr(s,7)+"</table>"),document.write("<div><h1>导出设置</h1></div>"),exportOption="<tr><td><label for='onlyPay'>只导出支付完成的订单：</label><input id='onlyPay' type='checkbox' value='1' checked='checked' /> &nbsp; <i style='font-size:12px;color:#666'>如果也要导到未支付订单，取消勾选</i> </td></tr>",exportOption+="<tr><td>导出支付时间之后的订单：日期：<input id='payTimeAfterDate' type='date' value='' placeholder='2020-04-14' />&nbsp;时间：<input id='payTimeAfterTime' type='time' value='' placeholder='00:00:00' />&nbsp;<i style='font-size:12px;color:#666'>设置时间后，将导出支付时间在这个之后的订单</i></td></tr>",exportOption+="<tr><td>导出页数范围：<input id='startPage' type='number' value='"+i+"' min='"+i+"' max='"+a+"' maxlength='3' size='3' style='width:3em'/> - <input id='endPage' type='number'  value='"+a+"'  min='"+i+"' max='"+a+"' maxlength='3' size='3' style='width:3em' />&nbsp; <i style='font-size:12px;color:#666'>修改此项可以导出指定页数的数据，默认是全部页</i> </td></tr>",exportOption+="<tr><td style='text-align:center'><a href='javascript:showData()' style='font-size:50px;color:red;font-weight:bold;cursor:pointer' >生成数据</a>&nbsp;&nbsp;<a href='javascript:location.reload()' style='font-size:20px;color:#000;font-weight:bold;cursor:pointer' >退出</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:save2Excel1()' id='downloadFile1' style='font-size:30px;font-weight:bold;cursor:pointer;display:none;' >下载发货表格</a>&nbsp;&nbsp;<a href='javascript:save2Excel2()' id='downloadFile2' style='font-size:30px;font-weight:bold;cursor:pointer;display:none;' >下载采购表格</a></td></tr>",exportOption+='<tr style=\'display:none\'><td><div id="cMsg" style="text-align:left;color:red;height:100px;width:100%;overflow-y:scroll"></div></td></tr>',document.write("<table class=gridtable>"+exportOption+"</table><br/>"),showData1=function(e,t){th=["订单id","订单时间","商品名称","商品编码","收件电话","收件人","收件邮编","收件人地址","物品数量","单价金额","合計金額","付款状态","支付时间"];var i=["orderId","orderTime","itemName","itemId","shipPhoneNumber","shipName","shipZipCode","shipAddress","quantity","unitPrice","totalPrice","payInfo","payActionTime"];trs=[],trs.push("<th>"+th.join("</th><th>")+"</th>");for(var a=[],o=0;o<data.length;o++){if(s=data[o]){var n={};if(n.orderId=s.orderId,n.orderTime=s.orderTime,n.shipPhoneNumber=s.shipPhoneNumber,n.shipName=s.shipLastName+s.shipFirstName,n.shipZipCode=s.shipZipCode,n.shipAddress=s.shipPrefecture+s.shipCity+s.shipAddress1+s.shipAddress2,n.totalPrice=s.totalPrice,n.payInfo=s.payInfo,n.payActionTime=s.payActionTime,itemCount=parseInt(s.itemCount),itemCount>1)for(var r=1;r<=itemCount;r++){var l={};l.orderId=n.orderId,l.orderTime=n.orderTime,l.shipPhoneNumber=n.shipPhoneNumber,l.shipName=n.shipName,l.shipZipCode=n.shipZipCode,l.shipAddress=n.shipAddress,l.totalPrice=n.totalPrice,l.payInfo=n.payInfo,l.payActionTime=n.payActionTime,l.itemName=s["title"+r],l.itemId=s["itemId"+r],l.quantity=s["quantity"+r],l.unitPrice=s["unitPrice"+r],a.push(l)}else n.itemName=s.title1,n.itemId=s.itemId1,n.quantity=s.quantity1,n.unitPrice=s.unitPrice1,a.push(n)}}a.sort(function(e,t){if(""!=e.payActionTime&&""!=t.payActionTime)return new Date(e.payActionTime).getTime()-new Date(t.payActionTime).getTime();if(""!=e.payActionTime)return 1;if(""!=t.payActionTime)return-1;{let i=e.orderId.split("-"),a=t.orderId.split("-");return parseInt(i[i.length-1])-parseInt(a[a.length-1])}});for(o=0;o<a.length;o++){var s=a[o],d=[];for(r=0;r<i.length;r++){var p=s[i[r]];p?d.push(p):d.push("")}1==e&&""==d[12]||(""!=t&&""!=d[12]&&new Date(d[12]).getTime()<new Date(t).getTime()||trs.push("<td>"+d.join("</td><td>")+"</td>"))}return'<table border="1"><tr>'+trs.join("</tr><tr>")+"</tr></table>"},gotoGetInfo=function(){for(var e=startPage;e<=endPage;e++)page_link_cache["_"+e]&&page_link_cache["_"+e].forEach(e=>{link.push(e)});data=[];for(e=0;e<link.length;e++)getInfo(e+1)},gotoShowData=function(){if(0!=loadCount)return console.log("还有数据在获取中，再等1秒"),void setTimeout(gotoShowData,1e3);link.forEach(e=>{data.push(order_cache[e])});var e=document.querySelectorAll(".dataColumn:checked"),t=[],i=[];e.forEach(e=>{var a=parseInt($(e).next().text())-1;t[a]=e.value,i[a]=e.id});var a="<tr><th>"+i.join("</th><th>")+"</th></tr>",o=[],n=$("#onlyPay")[0].checked,r=$("#payTimeAfterDate").val()+" "+$("#payTimeAfterTime").val();r.length<5&&(r=!1),dataTableFH=showData1(n,r),data.forEach((e,t)=>{if(!e||!e.itemCount)return!0;arrKey={},itemCount=parseInt(e.itemCount),e.itemCount=itemCount,Object.keys(e).forEach(t=>{oKey=t.replace(/\d+$/,""),e.hasOwnProperty(oKey+itemCount)&&!arrKey[oKey]&&(arrKey[oKey]=oKey)}),Object.keys(arrKey).forEach(t=>{e[t]=[];for(var i=1;i<=itemCount;i++)e[t].push(e[t+""+i])});let i=e.orderId.split("-");shopName=i.slice(0,i.length-1).join("-").toLowerCase(),e.itemName=[],e.firstImg=[],e.myLinkUrl=[];for(var a=1;a<=itemCount;a++)e.firstImg.push('<img src="https://item-shopping.c.yimg.jp/i/l/'+shopName+"_"+e["itemId"+a].toLowerCase()+'" width=106 height=106 />'),e.itemName.push(e["title"+a]),e.myLinkUrl.push("https://store.shopping.yahoo.co.jp/"+shopName+"/"+e["itemId"+a]+".html");var o=new Date,n=o.getMonth()+1+"-"+o.getDate();e.myNowDate=n,e.shipPhoneNumber="'"+e.shipPhoneNumber,myFullShipAddress="氏名 "+e.shipLastName+e.shipFirstName+"  郵便番号 "+e.shipZipCode+"  住所 "+e.shipPrefecture+e.shipCity+e.shipAddress1+e.shipAddress2+"  電話番号 "+e.shipPhoneNumber,e.myFullShipAddress=myFullShipAddress}),data.forEach((e,i)=>!e||!e.itemCount||(payActionTime=e.payActionTime,!(!n||""!=payActionTime)||(!!(r&&""!=payActionTime&&new Date(payActionTime).getTime()<new Date(r).getTime())||(s=[],d=[],e.index=o.length+1,t.forEach(t=>{if(-1!=t.indexOf("+")){keyArr=t.split("+"),values=[];for(var i=0;i<keyArr.length;i++)value=e[keyArr[i]],value&&values.push(value);s.push(values.join(""))}else value=e[t],value||(value=""),"object"==typeof value&&"function"==typeof value.push?1==value.length?s.push(value[0]):(d.push({index:s.length,values:value,key:t}),s.push(value)):s.push(value)}),void(d.length>0?(s.arrIndex=d,o.push(s)):o.push(s)))))),trs=[a];for(var l=o.length-1;l>=0;l--){var s=o[l],d=s.arrIndex;if(d){arrLen=d[0].values.length;var p="<tr>";s.forEach(e=>{"object"==typeof e&&"function"==typeof e.push?p+="<td>"+e[0].replace(/�/g," ")+"</td>":p+="<td rowspan='"+arrLen+"'>"+e+"</td>"}),p+="</tr>";for(var c=1;c<arrLen;c++)p+="<tr>",d.forEach(e=>{"itemOption"==e.key?p+="<td>"+e.values[c].replace(/�/g," ")+"</td>":p+="<td>"+e.values[c]+"</td>"}),p+="</tr>";trs.push(p)}else trs.push("<tr><td>"+s.join("</td><td>")+"</td></tr>")}var u=document.querySelector("#orderTable");u?u.innerHTML=trs.join(""):(document.write("<table class=gridtable id=\"orderTable\" style='width:100%'>"+trs.join("")+"</table><br/><br/>"),u=document.querySelector("#orderTable")),trs.length>1&&($("#downloadFile").show(),$("#downloadFile1").show(),$("#downloadFile2").show())},showData=function(e){$("#orderTable").remove(),startPage=parseInt(document.querySelector("#startPage").value),endPage=parseInt(document.querySelector("#endPage").value),link=[],orderCount=-1;for(var t=startPage;t<=endPage;t++)getotherlink(t,endPage,!1)},save2Excel=function(){var e=new Date,t=e.getDate(),i=e.getMonth()+1,a=e.getHours(),o=e.getMinutes(),n=e.getSeconds(),r=e.getFullYear()+""+(i<10?"0"+i:i)+(t<10?"0"+t:t)+a+o+n,l=$("#orderTable");table2Excel(l,r+"-采购"),table2Excel(dataTableFH,r+"-发货")},save2Excel1=function(){var e=new Date,t=e.getDate(),i=e.getMonth()+1,a=e.getHours(),o=e.getMinutes(),n=e.getSeconds(),r=e.getFullYear()+""+(i<10?"0"+i:i)+(t<10?"0"+t:t)+a+o+n;table2Excel(dataTableFH,r+"-发货")},save2Excel2=function(){var e=new Date,t=e.getDate(),i=e.getMonth()+1,a=e.getHours(),o=e.getMinutes(),n=e.getSeconds(),r=e.getFullYear()+""+(i<10?"0"+i:i)+(t<10?"0"+t:t)+a+o+n,l=$("#orderTable");table2Excel(l,r+"-采购")},table2Excel=function(e,t){isMac=!1,isWindows=!1;var i,a,o=-1;"string"==typeof e?i=e:(a=e,isMac=-1!=navigator.userAgent.toLowerCase().indexOf("mac"),isWindows=-1!=navigator.userAgent.toLowerCase().indexOf("windows"),(isMac||isWindows)&&(a.find("tr:eq(1)").find("td").each((e,t)=>{if(1==$(t).find("img").length)return o=e,!1}),-1!=o&&(a.find("th:eq("+o+")").width("165px"),a.find("tr:gt(0)").height("165px"))),i=a[0].outerHTML);var n="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>";n+='<meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">',n+='<meta http-equiv="content-type" content="application/vnd.ms-excel',n+='; charset=UTF-8">',n+="<head>",n+="\x3c!--[if gte mso 9]>",n+="<xml>",n+="<x:ExcelWorkbook>",n+="<x:ExcelWorksheets>",n+="<x:ExcelWorksheet>",n+="<x:Name>",n+="{worksheet}",n+="</x:Name>",n+="<x:WorksheetOptions>",n+="<x:DisplayGridlines/>",n+="</x:WorksheetOptions>",n+="</x:ExcelWorksheet>",n+="</x:ExcelWorksheets>",n+="</x:ExcelWorkbook>",n+="</xml>",n+="<![endif]--\x3e",n+="</head>",n+="<body>",n+=i=i.replace(/<br\/>/g,"\n"),n+="</body>",n+="</html>",-1!=o&&(a.find("th:eq("+o+")").width(""),a.find("tr:gt(0)").height(""));var r="data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(n),l=document.createElement("a");l.href=r,l.style="visibility:hidden",l.download=t+".xls",document.body.appendChild(l),l.click(),document.body.removeChild(l)}}();